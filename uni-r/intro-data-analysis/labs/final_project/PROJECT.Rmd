---
title: "Korelacja między Edukacją a zarobkami"
subtitle: "Projekt zaliczeniowy z przedmiotu \"Wstęp do analizy danych\""
author: "Paulina Kania"
date: "2026-sty"
output: 
  html_document:
        toc: true
        toc_depth: 3
        toc_float: true

---

# Wstęp

## Cel projektu
> *"Czy ścieżka STEM to jedyna droga do sukcesu w Stanach Zjednoczonych"*

Ameryka jest jednym z najbardziej skomplikowanych państw na świecie - z bardzo intrygującym systemem edukacji. Moim głownym zamysłem początkowo bylo dokonanie analizy kierunkow powiązanych z popularnym określeniem *"STEM" - science, technology, engineering and mathematics* gdyż kierunki i uczelnie z tym słowem powiązane są najbliższe motywowi edukacji AGH. Jednakże przy aktualnej dominacji rynku technologicznego (STEM) nad pozostalymi dziedzinami np. humanistycznymi (liberal arts) warto też porównać zarobki absolwenta Informatyki (Computer Science) do przykladowo Historyka (History). Dane z Kaggle są co prawda lekko przestarzałe (ponieważ powstały 9 lat temu), jednak trend wzrostu technologicznego pojawił się długo przed. Należy pamiętać, że od tego czasu rynek technologiczny przeszedł dynamiczne zmiany (rozwój AI i pandemia), co mogło jeszcze bardziej powiększyć dystans między STEM a innymi dziedzinami. Istnieje popularny motyw o którym głośno na zagranicznych portalach społęcznościowych - o "humanistycznym długu", czyli fakt iż zadłużenie studenckie (student loans) przerasta średnie zarobki po ukonczeniu studiów. W poniższej analizie postaram się przybliżyć zagadnienia związane z wybranym tematem.

## Dane użyte w analizie

```{r}
# Pobieranie danych z plików pobranych z strony Kaggle
degreesThatPayBack <- read.csv("degrees-that-pay-back.csv")
salariesByCollegeType <- read.csv("salaries-by-college-type.csv")
salariesByRegion <- read.csv("salaries-by-region.csv")
```

Dane pochodzą z: <https://www.kaggle.com/datasets/wsj/college-salaries?resource=download>

### Zawartość i Struktura
```{r, echo=FALSE, warning=FALSE, message=FALSE}
library(tidyverse) # :p
```
```{r}
glimpse(degreesThatPayBack)
glimpse(salariesByCollegeType)
glimpse(salariesByRegion)
```

---

# Data Wrangling

## Biblioteki
- tidyverse: pakiet podstawowy do analizy danych
- naniar: do sprawdzenia procentowego udziału braku danych (NA)
- datawizard: data wrangling
- knitr: estetyka i czytelność
- corrplot: dla macierzy korelacji
- ggrepel: do wykresu anomalii
```{r, echo=TRUE, warning=FALSE, message=FALSE}
library(naniar)
library(knitr)
library(ggrepel)
library(datawizard)
library(corrplot)
library(tidyverse)
```

## Data cleaning

### degrees-that-pay-back.csv

```{r, echo=TRUE}
# zaczynam od przerobienia i czyszczenia danych z pliku 'degrees-that-pay-back'
degree <- degreesThatPayBack
str(degree)
```

Na pierwszy rzut oka można zauważyć już wstępne problemy, czyli bardzo długie tytuły kolumn jak i nieużywalny format danych zapisanych jako "chr" zamiast "num"

```{r}
# zmiana nazw kolumn - dla czytelności i łatwiejszej obsługi danych
# użyje do tego dplyr::rename()
degree <- rename(
  degree,
  major = Undergraduate.Major, 
  career_start = Starting.Median.Salary, 
  career_mid = Mid.Career.Median.Salary,
  p_change = Percent.change.from.Starting.to.Mid.Career.Salary,
  p10_salary = Mid.Career.10th.Percentile.Salary,                
  p25_salary = Mid.Career.25th.Percentile.Salary,               
  p75_salary = Mid.Career.75th.Percentile.Salary,            
  p90_salary = Mid.Career.90th.Percentile.Salary
  )

# zmiana na lepsze
colnames(degree)

# zmiana typu danych - na numeryczne by móc je używać do analizy
# użyje do tego stringr::str_replace_all()

degree <- degree %>%
  mutate(
    career_start = as.numeric(str_replace_all(career_start, "[\\$,]", "")),
    career_mid = as.numeric(str_replace_all(career_mid, "[\\$,]", "")),
    p10_salary = as.numeric(str_replace_all(p10_salary, "[\\$,]", "")),
    p25_salary = as.numeric(str_replace_all(p25_salary, "[\\$,]", "")),
    p75_salary = as.numeric(str_replace_all(p75_salary, "[\\$,]", "")),
    p90_salary = as.numeric(str_replace_all(p90_salary, "[\\$,]", ""))
    )

# kolumna p_change to: (degree$career_mid-degree$career_start)/degree$career_start*100, czyli wzrost procentowy na bazie roku startowego 

kable(head(degree))
```
Teraz kolej na pozostałe pliki - które wykonam analogicznie

### salaries-by-college-type.csv
```{r}
# wybralam nazwy zmiennych z wzgledu na charakterystyczną ceche zestawu danych: degree, college i region
college <- salariesByCollegeType
str(college)

college <- college %>%
  rename(
    university = School.Name,
    type = School.Type,
    career_start = Starting.Median.Salary, 
    career_mid = Mid.Career.Median.Salary,
    p10_salary = Mid.Career.10th.Percentile.Salary,                
    p25_salary = Mid.Career.25th.Percentile.Salary,               
    p75_salary = Mid.Career.75th.Percentile.Salary,            
    p90_salary = Mid.Career.90th.Percentile.Salary
  )

college <- college %>%
  mutate(
    career_start = as.numeric(str_replace_all(career_start, "[\\$,]", "")),
    career_mid = as.numeric(str_replace_all(career_mid, "[\\$,]", "")),
    p10_salary = as.numeric(str_replace_all(p10_salary, "[\\$,]", "")),
    p25_salary = as.numeric(str_replace_all(p25_salary, "[\\$,]", "")),
    p75_salary = as.numeric(str_replace_all(p75_salary, "[\\$,]", "")),
    p90_salary = as.numeric(str_replace_all(p90_salary, "[\\$,]", ""))
  )

kable(head(college))
```
Zauważyłam już przy pierwszym wglądzie w dane, iż jest dużo brakujących pozycji w kolumnach percentylowych - i nie byłam pewna na ile to może zakłócić mojej analizie. Przy "mutacji" zawartości na liczbowe tekstowy zapis "N/A" zmienił się na prawdziwy i odczytany przez R "NA" przez co biblioteka naniar wykryje gdzie dokładnie mam dziury danych.  

```{r}
gg_miss_var(college)
```

Jedyne braki danych mam w uzupełniajacych sie kolumnach 90- i 10-percentylowych, więc w dalszej analizie albo muszę znaleść sposób na ominięcie ich albo używanie 25- i 75-percentyli.

### salaries-by-region.csv

```{r}
region <- salariesByRegion
str(region)

region <- region %>%
  rename(
    university = School.Name,
    career_start = Starting.Median.Salary, 
    career_mid = Mid.Career.Median.Salary,
    p10_salary = Mid.Career.10th.Percentile.Salary,                
    p25_salary = Mid.Career.25th.Percentile.Salary,               
    p75_salary = Mid.Career.75th.Percentile.Salary,            
    p90_salary = Mid.Career.90th.Percentile.Salary
  )

region <- region %>%
  mutate(
    career_start = as.numeric(str_replace_all(career_start, "[\\$,]", "")),
    career_mid = as.numeric(str_replace_all(career_mid, "[\\$,]", "")),
    p10_salary = as.numeric(str_replace_all(p10_salary, "[\\$,]", "")),
    p25_salary = as.numeric(str_replace_all(p25_salary, "[\\$,]", "")),
    p75_salary = as.numeric(str_replace_all(p75_salary, "[\\$,]", "")),
    p90_salary = as.numeric(str_replace_all(p90_salary, "[\\$,]", ""))
  )
kable(head(region))

gg_miss_var(region)
```

Dane pogrupowane przez region i przez typ szkoły są bardzo podobne - będe musiała na te zbiory zwrócić szczegółową uwage przy analizie danych

---

# Exploratory Data Analysis (EDA)

## Pytania Badawcze 
Patrząc na zestaw danych zanim otworzyłam RStudio zapisałam sobie w notatniku pytania które sobie stawiłam związane z moim tematem projektu - i po zapisaniu posortowałam je w logiczny tok opowieści. Pytania pozwolą zweryfikować rynkową wartość edukacji wyższej w USA według trzech sekcji.

## Sekcja I: Fundamenty - Krajobraz płac w USA 

### Pytanie 1: Dominacja STEM – fakt czy mit?  
Porównanie podstawowych statystyk opisowych (mediana, średnia, odchylenie standardowe) dla kierunków STEM oraz pozostałych dziedzin na początku i w środku kariery 

Mając tabele "degree" widać wszystkie reprezentowane kierunki studiowania ale bez dokładnego oznaczenia do których z typów studiów (STEM, human czy zarządzanie) należy. By dokonać ogólnej analizy musimy ustalić typ studiów jak i ich ogólna kategoria - dla uproszczenia analizy bedzie to STEM vs others.

```{r}

engineering <- c("Aerospace Engineering", "Chemical Engineering", "Civil Engineering", 
  "Computer Engineering", "Electrical Engineering", "Industrial Engineering", 
  "Mechanical Engineering", "Architecture")

tech <- c("Computer Science", "Information Technology (IT)", 
  "Management Information Systems (MIS)")

math <- c("Math")

science <- c("Biology", "Chemistry", "Geology", "Physics", 
             "Nursing", "Nutrition", "Physician Assistant")

liberalart <- c("Anthropology", "Art History", "Communications", "Criminal Justice", 
  "Drama", "Education", "English", "Film", "Geography", "History", 
  "Journalism", "Music", "Philosophy", "Political Science", 
  "Psychology", "Religion", "Sociology", "Spanish", "International Relations")

business <- c("Accounting", "Business Management", "Economics", "Finance", 
  "Marketing", "Hospitality & Tourism", "Health Care Administration",
  "Construction", "Agriculture", "Forestry", "Graphic Design", "Interior Design")

degree <- degree %>% 
  mutate(
    type = case_when(
      major %in% engineering ~ "Engineering",
      major %in% tech ~ "Technology",
      major %in% math ~ "Mathematics",
      major %in% science ~ "Science",
      major %in% liberalart ~ "Liberal Arts",
      major %in% business ~ "Business"
    )
  )

table(degree$type)

degree <- degree %>% 
  mutate(
    category = case_when(
      type %in% c("Engineering", "Technology", "Mathematics", "Science") ~ "STEM",
      TRUE ~ "Others"
    )
  )

table(degree$category)
```
Patrząc wstępnie na liczbe występowania każdego typu studiów musze niestety zwrócić uwagę na jeden kierunek matematyczny. W polskim posiadamy matematyke stosowaną, ficzyną i tym podobne ale na liście niestety nie ma takich wyróżnień. Po za tym podział jest w miare zrównoważony z zauważalnym wyżem w Liberal Arts jak i Business gdy są to szersze kategorie i sumując wszystkie kierunki STEM, nie osiągają one przewage liczbową.

```{r}
# Statystyka Opisowa
degreestart <- degree %>% group_by(category) %>%
  summarise(
    mean_start = mean(career_start),
    median_start = median(career_start),
    max_start = max(career_start),
    min_start = min(career_start),
    range_start = max(career_start)-min(career_start),
    sd_start = sd(career_start),
  )

degreestart <- data_rotate(degreestart, colnames = TRUE)
degreestart

# przewaga średniej
degreestart$STEM[1]/degreestart$Others[1]
# róznica średniej
degreestart$STEM[1]-degreestart$Others[1]
```
Już w pierwszej analizie statystyczej widać różnicę miedzy kierunkami technicznymi a pozostałymi. Średnia zarobków jest prawie 34% wyższa dla absolwentów STEM już na początku kariery - a co ciekawe, mediana dla STEM jest prawie równa wartości maksymalnej dla pozostałych kierunków. Grupa "others" charakteryzuje się jednak znacznie wiekszą przewidywalnością - niskie odchylenie standardowe i relatywnie mały rozstęp (range). Kierunki techniczne wykazują się większym zróżnicowaniem wewnętrznym.

```{r}
degreemid <- degree %>% group_by(category) %>%
  summarise(
    mean_mid = mean(career_mid),
    median_mid = median(career_mid),
    max_mid = max(career_mid),
    min_mid = min(career_mid),
    range_mid = max(career_mid)-min(career_mid),
    sd_mid = sd(career_mid),
  )
degreemid <- data_rotate(degreemid, colnames = TRUE)
degreemid

# przewaga średniej
degreemid$STEM[1]/degreemid$Others[1]
# różnica średniej
degreemid$STEM[1]-degreemid$Others[1]
```
Z ciekawszych obserwacji mimo wzrostu różnicy średnich w środku kariery (porównując do początkowej wartości), różnica procentowa zmalała. Warto też spojrzeć na maksymalną wartość dla kierunków nie-STEM i mediane dla STEM - wartości są bardzo do siebie zbliżone, co sugeruje o porównywalności "sufitu humanistów" a "podłodze inżynierów".
Odchylenie dla obu grup skoczyło w górę - po 10 latach w zawodzie już nie tylko studia decydują o zarobkach ale gromo zewnętrznych czynników a zarobki minimalne są bardzo do siebie zbliżone.

```{r}
degree %>% 
  ggplot(aes(career_start)) + 
  geom_histogram(fill="palegreen3", colour="darkgray", binwidth=10000, alpha=0.6) +
  geom_histogram(aes(career_mid), fill="orchid3", colour="darkgray", binwidth=10000, alpha=0.6) +
    labs(title = "Histogram zarobków (skala w 10000$)",
         subtitle="Zielony - początek kariery, fioletowy - po 10 latach ukończenia studiów",
      x="Zarobki w dollarach ($)",
      y="Ilość kierunków w danym przedziale",
    ) +
  theme_bw()

```

### Pytanie 2: Dynamika wzrostu wynagrodzeń  
Identyfikacja kierunków o największym i najmniejszym przyroście płac w czasie, czy absolwenci nauk humanistycznych z czasem zmniejszają dystans finansowy do grup STEM.

```{r}
degree %>%
  arrange(desc(p_change)) %>%
  head(15) %>%
  ggplot(
    aes(x=reorder(major, p_change), y=p_change, fill=category)
    ) + 
  geom_col()+
  scale_fill_manual(values=c('STEM'='plum2', 'Others'='skyblue1')) +
  coord_flip() +
  labs(title = "Największe zmiany procentowe kariery: Start vs po 10 latach",
       x = NULL,
       y = "Zmiana wyrażona w procentach (%)") + theme_bw()
```

```{r}

degree %>%
  arrange(desc(p_change)) %>%
  tail(15) %>%
  ggplot(
    aes(x=reorder(major, p_change), y=p_change, fill=category)
    ) + 
  geom_col() +
  scale_fill_manual(values=c('STEM'='plum2', 'Others'='skyblue1')) +
  coord_flip() +
  labs(title = "Najmniejsze zmiany procentowe kariery: Start vs po 10 latach",
       x = NULL,
       y = "Zmiana wyrażona w procentach (%)") + theme_bw()

```

Choć inżynierowie zarabiają więcej kwotowo - humaniści i "biznesowcy" wykazują się dynamiczną adaptacją. Choć po wyjściu z uczelni ich zarobki nie konkurują z płącą dla STEM, dużo z nich zyskuje w dalszej części kariery. Co zaskakujące dwa kierunki medyczne - Asystent lekarski i Pielęgniarstwo ukazują odstającą od reszty braku rozwoju. Mają świetny start ale bardzo mały "sufit".

```{r}
degree %>% 
  group_by(type) %>% 
  top_n(5, career_mid) %>%
  ggplot(
    aes(y = reorder(major, career_mid), colour=type)
    ) +
  geom_segment(
    aes(x=career_start, xend=career_mid), 
    linewidth=1.2 
    ) +
  geom_text(
    aes(x=(career_start+career_mid)/2, label=paste0(p_change, "%")), 
    nudge_y=0.3,
    color='black'
    ) +
  scale_color_manual(values=c('Engineering'='deepskyblue2', 'Mathematics'='deepskyblue4', 'Science'='darkseagreen4', 'Technology'='seagreen3', 'Liberal Arts'='plum1', 'Business'='plum3')) +
  theme_bw() +
  labs(
    title = "Top3 Kierunki z każdego rodzaju nauki - i ich wzrost",
    x = "Zarobki w ($)",
    y = NULL,
    subtitle = "Zmiana procentowa między początkiem a środkiem kariery - p odana nad linią wykresu"
  ) + 
  scale_x_continuous(limits= c(min(degree$career_start),max(degree$career_mid))) 
```

Powyższy wykres przedstawia moment startowy kariery i zmiane procentową do momentu średniego - i wybrałam tu 5 najlepiej zarabiających kierunków podzielonych na kategorie "type". Wykres pomaga zobrazować jak zmiana procentowa po 10 latach wygląda na faktycznych zarobkach. Mimo dużych wzrostów procentowych humaniści i "business" studenci przy realnych liczbach kuleją przy zarobkach STEM. Co ciekawe - dobrze widać tu zarobki asystenta lekarskiego (Physician Assistant). Mimo bardzo małej zmiany zarobków dalej utrzymuje się w topce wszystkich kierunków, co pokazuje, że niski sufit nie jest wcale taki zły gdy pokój się znajduje na metaforycznym 15stym piętrze.

### Pytanie 3: Wewnętrzna hierarchia "Imperium STEM".  
Analiza porównawcza subdziedzin.

```{r}
cor_data <- degree %>%
  mutate(
    is_stem = ifelse(category == "STEM", 1, 0)
    ) %>%
  select(is_stem, career_start, career_mid, p_change)  

cor = cor(cor_data)
corrplot(cor, method = "color", type = "upper", tl.col = "black", diag = FALSE)
```

Macierz korelacji pokazuje silną dodatnią zależność między przynależnością do grupy STEM a wynagrodzeniem początkowym (z ujemną korelacją co do procentu zmiany) więc warto sobie zadać pytanie: która z subdziedzin faktycznie króluje...

```{r}

degree %>%
  filter(category=="STEM") %>%
  ggplot(
    aes(y = reorder(major, career_start), x = career_start, fill = type)) +
  geom_col(colour='darkgray', alpha = 0.5) +
  scale_fill_manual(values=c('Engineering'='deepskyblue2', 'Mathematics'='deepskyblue4', 'Science'='darkseagreen4', 'Technology'='seagreen3')) +
  geom_col(
    aes(y = reorder(major, career_mid), x = career_mid), alpha=0.3) +
  labs(
    title = "Kto króluje w STEM",
    x = "Zarobki w dollarach ($)",
    y = NULL,
    subtitle = "Porównanie początków kariery i środkowych zarobków"
  ) + theme_bw()
  
```

Już na pierwszy rzut oka widać wyraźną przewagę kierunków inżynieryjnych (Engineering), które okupują szczyt zestawienia. Warto zwrócić uwagę na pozycję kategorii Technology. Choć w badanych danych plasuje się ona tuż za inżynierią, współczesny boom na technologie AI prawdopodobnie wyniósł te profesje ponad "tradycyjną naukę" (Science). Termin "STEM" jest nadużywany jako gwarancja sukcesu. Prawdziwe pieniądze leżą w "TE".

## Sekcja II: Analiza ryzyka

### Pytanie 4: Bezpieczny wybór vs. hazard zawodowy.  
Wskazanie kierunków "bezpiecznych" oraz tych o wysokim risk/reward.

```{r}
degree %>% ggplot(aes(x = career_mid, y = reorder(type, career_mid), fill = type)) +
  geom_boxplot(alpha = 0.7) +
  theme_bw() +
  scale_fill_manual(values=c('Engineering'='deepskyblue2', 'Mathematics'='deepskyblue4', 'Science'='darkseagreen4', 'Technology'='seagreen3', 'Liberal Arts'='plum1', 'Business'='plum3')) +
  labs(title = "Stabilność finansowa",
       subtitle = "Rozkład zarobków w środku kariery według typu edukacji",
       y = NULL, 
       x = "Wynagrodzenie w ($)")
```

Najdziwniejszą pozycją wykresu jest pozycja "Mathematics", jednak objaśnienie jest proste: pod tą kategorią jest podpięty jedynie jeden kierunek. Kategoria zatem jest praktycznie niemożliwa do przedstawienia na wykresie Boxplot. Innymi ciekawymi pozycjami to "Business" i "Science" które mają bardzo szerokie pudełka. Oznacza to dużą niepewność. Wrzuca się też w oko jeden Outlier w kategorii Engineering. 

```{r}
degreerisk <- degree %>% 
  filter(!is.na(p10_salary) & !is.na(p90_salary)) %>%
  mutate(
    risk25 = p75_salary - p25_salary,
    risk10 = p90_salary - p10_salary
  ) 

degreerisk %>%
  group_by(type) %>%
  top_n(5, career_mid) %>%
  ggplot(
    aes(y = reorder(major, p75_salary), color=type)
    ) +
  geom_segment(
    aes(x=p25_salary, xend=p75_salary), linewidth=1.2,) +
  geom_text(
    aes(x=(p25_salary+p75_salary)/2, label = risk25), nudge_y=0.3, color='black') +
  theme_bw() +
  scale_color_manual(values=c('Engineering'='deepskyblue2', 'Mathematics'='deepskyblue4', 'Science'='darkseagreen4', 'Technology'='seagreen3', 'Liberal Arts'='plum1', 'Business'='plum3')) +
  labs(
    title = "Rozpiętość płac",
    x = "Wynagrodzenie w ($)",
    y = NULL,
    subtitle = "Różnica między najlepiej a najgorzej zarabiającymi absolwentami"
  ) + 
  scale_x_continuous(limits= c(min(degree$p25_salary),max(degree$p75_salary)))
```

Niespodziewanie pozycje numer jeden zajmuje Ekonomia o bardzo szerokiej rozpiętości. Oznacza to niepewne zarobki przyszłościowe dla absolwentów. Oczywiście ekonomia łączy z sobą dużo ścisłych jak i humanistycznych zagadnień, dzięki czemu absolwenci mogą znaleść pracę w dużej ilości dziedzin. Po ukończeniu studiów wiele czynników zewnętrznych wpływa na to jak wygląda płaca ekonomisty. Jest to trend dla wielu biznesowych i humanistycznych kierunków, gdzie płace STEM charakteryzują się mniejszą rozpiętością. Zaczynają wyżej zarobkowo ale względnie wiekszość stanowisk są równomiernie prestiżowe, w porównaniu z innymi dziedzinami.

### Pytanie 5: Sufit płacowy: STEM vs. Biznes.  
Sprawdzenie, która z grup szybciej osiąga pełny potencjał zarobkowy (z osobistej ciekawości studiując Informatyke na Wydziale Zarządzania).

```{r}
degree %>% 
  filter(type == "Business" | category=="STEM") %>%
  ggplot(aes(x = career_start, y = p90_salary, color = type)) +
  geom_point(size = 3, alpha = 0.6) +
  theme_bw() +
  geom_smooth(method = "lm", se=F) +
  scale_color_manual(values=c('Engineering'='deepskyblue2', 'Mathematics'='deepskyblue4', 'Science'='darkseagreen4', 'Technology'='seagreen3', 'Business'='plum3')) +
  labs(
    title = "Relacja: Start kariery vs. Szczyt finansowy",
    x = "Płaca początkowa",
    y = "90. percentyl zarobków"
    )
```

Na wykresie powyżej widać w sposób dosłowny sufit finansowy o którym ciągle wspominam. 90-ty percentyl to inaczej 10 procent najlepiej zarabiających absolwentów danego kierunku. "Business" zaczyna nisko lecz niesamowicie wysoko wystrzela zakłądając najlepsze dla studenta warunki. Inżynierowie natomiast są bardziej stabilni. Kąt nachylenia linii którą tworzą niebieskie punkty jest mniejszy niż ten dla Business, jednak kropki zaczynają z wiele wiekszymi zarobkami początkowymi.

### Pytanie 6: Anomalie humanistyczne i businessowe (Outliers).  
Identyfikacja konkretnych kierunków które przechodzą niestandardowy dla swojej kategorii wzrost.

Ekonomia jak i inne kierunki "Business" ewidentnie się odznaczały przy porównywaniu z STEM. Jednak warto również popatrzeć troche głębiej łącząc Business i Liberal Arts, i dokonać na tych kategoriach osobną analize

```{r}
outlierstable <- degree %>%
  mutate(
    growth = p90_salary / career_start
    ) %>%
  arrange(desc(growth)) %>%
  head(10) %>%
  select(major, type, career_start, p90_salary, growth)

kable(outlierstable)

outliersname <- degree %>%
  filter(category == "Others") %>%
  arrange(desc(p90_salary)) %>%
  slice(1:5)
```

```{r}
degree %>% 
  filter(category=="Others") %>%
  ggplot(aes(x = career_start, y = p90_salary, color = type)) +
  geom_point(size = 3, alpha = 0.6) +
  geom_text_repel(data = outliersname, 
                  aes(label = major), 
                  size = 3)+
  geom_smooth(method = "lm", se=F) +
  theme_bw() +
  scale_color_manual(values=c('Liberal Arts'='plum1', 'Business'='plum3')) +
  labs(
    title = "Anomalie dla kierunków nie-STEM",
    x = "Płaca początkowa",
    y = "90. percentyl zarobków"
    )
```

Niektóre kierunki aż czterokrotnie powiekszają swoje zarobki (oczywiście biorąc pod uwagę szczyt możliwych płac). Widać również, iż większość Outlierów pochodzą jednak z kategorii business - oprócz filozofii (Philosophy). Pozostałe kierunki układają sie w podobnej ćwiartce wykresu (przy zarobkach startowych w wysokosci 40000$ i suficie percentylowym 150000$)

## Sekcja III: Wpływ instytucji i geografii

```{r}
table(college$type)
table(region$Region)
```

Przeglądając pozostałe dwa datasety, wrzucają sie w oczy wartości typu uczelni i regionu. Tu typ uczelni "engineering" to nie to samo co kierunek "engineering" choć sugeruje, iż na takiej uczelni istnieje dużo inżynierskich kierunków. W ostatniej części EDA przyjrzymy się jak te wartości kształtują całokształt edukacji w Ameryce Północnej.

### Pytanie 7: Prestiż Ivy League vs. praktyczność State Schools.
czy "historyk z Harvardu" zarabia więcej niż "informatyk z uczelni stanowej"? Czy nazwa uczelni niweluje różnice między kierunkami?

```{r}
college %>% 
  ggplot(aes(x = type, y = career_mid, fill = type)) +
  geom_boxplot() +
  coord_flip() +
  theme_bw() +
  scale_fill_manual(values=c('Engineering'='plum1', 'Ivy League'='plum3', 'Liberal Arts'='hotpink3', 'Party'='lightblue4', 'State'='skyblue2')) +
  labs(
    title = "Wykres pudełkowy według typu uczelni",
    y = "Wynagrodzenie po 10 latach w ($)",
    x = "Typ uczelnii"
  )

Q1 <- quantile(college$career_mid, 0.25, na.rm = TRUE)
Q3 <- quantile(college$career_mid, 0.75, na.rm = TRUE)
IQR_value <- Q3 - Q1

gorna_granica <- Q3 + 1.5 * IQR_value
dolna_granica <- Q1 - 1.5 * IQR_value

outliers_list <- college %>%
  filter(career_mid > gorna_granica | career_mid < dolna_granica)

kable(outliers_list %>% select(university, type, career_mid))
```

Pierwsze co postanowiłam sprawdzić to kolejne outliery w kategorii uczelni. By odpowiedzieć na powyżej podane pytanie użyłam początkowo średniej by zrealizować różnice między typami szkół jednak wartości nie zgadzały mi się z oczekiwaną analizą, więc zdecydowałam na użycie wartości środkowej. Mediana pozwala na rzetelne przedstawienie sytuacji finansowej 'typowego' absolwenta, chroniąc wyniki przed zniekształceniem przez nieliczne, ekstremalnie wysokie lub niskie zarobki

```{r}
ivystate <- college %>%
  filter(type %in% c("Ivy League", "State", "Engineering")) %>%
  group_by(type) %>%
  summarise(
    school_count = n(),
    median_start = median(career_start, na.rm = TRUE),
    median_mid = median(career_mid, na.rm = TRUE),
    p10 = median(p10_salary, na.rm = TRUE),
    p90 = median(p90_salary, na.rm = TRUE),
    max_mid = max(career_mid, na.rm = TRUE)
  ) %>%
  arrange(desc(median_mid))

kable(ivystate)
```

Zazwyczaj uczelnie typu Engineering oferują wyższy start niż Ivy League, a najniżej wynagradzani inżynierowie również zarabiają lepiej niż ich rówieśnicy z innych grup. Oznacza to, że rynek płaci za twarde umiejętności „od zaraz”. Ivy League często jednak przegania kierunki techniczne po 10 latach pracy. Dlaczego? Ponieważ prestiż otwiera drzwi do zarządów oraz daje możliwości networkingowe, co wyraźnie widać w zarobkach górnych 10% absolwentów.

Mediana zarobków,  zarówno początkowa, jak i po 10 latach, jest dla Ivy League znacznie wyższa niż dla uczelni stanowych (State). Dowodzi to, że marka uczelni faktycznie działa jak dopalacz kariery, niezależnie od tego, czy absolwent ukończył historię, czy kierunek STEM. Najbardziej lukratywne uczelnie to:

```{r}
college %>%
  filter(type %in% c("Ivy League", "State", "Engineering")) %>%
  arrange(desc(career_mid)) %>%
  head(20) %>%
  ggplot(
    aes(x = career_mid, y = reorder(university, career_mid), fill = type)
    ) +
  geom_col() +
  scale_fill_manual(values=c('Engineering'='plum1', 'Ivy League'='plum3', 'State'='skyblue2')) +
  theme_bw() +
  labs(title = "Szczyt wynagrodzenia",
       subtitle = "Top 20 uczelni pod względem zarobków w środku kariery",
       x = "Mediana zarobków w ($)",
       y = NULL)
```

### Pytanie 8: Stabilność finansowa a profil uczelni.
Porównanie rozkładów gęstości zarobków dla różnych typów szkół

```{r}
college %>%
  ggplot(aes(x = career_mid, fill = type)) +
  geom_density(alpha = 0.5) +
  theme_bw() +
  scale_fill_manual(values=c('Engineering'='plum1', 'Ivy League'='plum3', 'Liberal Arts'='hotpink3', 'Party'='lightblue4', 'State'='skyblue2')) +
  labs(title = "Rozkład prawdopodobieństwa zarobków wg typu uczelni",
       x = "Wynagrodzenie Mid-Career w ($)",
       y = "Gęstość występowania",
       fill = "Typ uczelni")
```

Krzywa dla Ivy League jest najbardziej wysunięta na prawo, co ponownie potwierdza moje wcześniejsze wnioski iż przestiż uczelni daje lepszy start w karierze i otwiera drzwi na rozwój. Z ciekawszych obserwacji krzywa dla Engineering jest najszersza i najniższa co sugeruje pewną niepewność zarobkową gdy Party jest bardzo szczupłe i wysunięte do góry. Mimo niższego średniego wynagrodzenia jest ono o wiele pewniejsze niż przykładowo dla Liberal Arts czy State, co niektórzy ludzie sobie cenią w wyborze studiów. Liberal Arts szczególnie na wykresie wręcz "merge"uje State i Engineering. Stoi w limbo między dużą stanową uczelnią a prestiżem uczelni technicznych po któruch wnioskujemy lepsze zarobki

### Pytanie 9: Geografia sukcesu: Regiony USA.
Który region oferuje najwiekszą pomoc w przyszłych zarobkach. Sprawdzenie, co ma silniejszy wpływ na płacę: lokalizacja czy typ uczelni.

```{r}
region %>%
  group_by(Region) %>%
  top_n(3, career_mid) %>%
  ggplot(aes(x = Region, y = university, fill = career_mid)) +
  geom_tile() +
  scale_fill_gradient(low = "lightgray", high = "steelblue") +
  theme_minimal() +
  labs(title = "Ranking regionalny",
       x = "Region",
       y = NULL,
       fill = "Zarobki Mid-Career") +
  theme(axis.text.x = element_text(angle = 90, hjust=1)) +
  coord_flip()
```

Jest to nieuniknione by w internecie nie natrafić na rywalizacje regionów USA. W każdej możliwej dziedzinie czy to edukacja czy muzyka Hip-Hop różne stany z sobą konkurują, spowodowane między innymi przez przeogromn rozmiar geograficzny Ameryki. Na Heatmapie widać dwie odznaczające się ciemniejsze obszary: Northeastern i California, co nie powinno nikogo zdziwić. To wybrzeże to miejsce powstania prestiżowych uczelni takich jak: MIT, Yale, Princeton czy też Stanford, które reprezentują z sobą dużą sieć do rozwoju studentów i dostęp do najsławniejszego regionu karierowego w Ameryce - Silicon Vallej, zlokalizowany w Kalifornii.

### Pytanie 10: "Złoty bilet" – i podsumowanie wyników.

```{r, fig.height=10, fig.width=8}
degree %>% 
  arrange(desc(career_start)) %>%
  ggplot(
    aes(y = reorder(major, career_start), x = career_start, fill=category)
  ) +
  geom_col(colour='darkgray', alpha = 0.5) +
  geom_col(
    aes(y = reorder(major, career_mid), x = career_mid), alpha=0.4
  ) +
  scale_fill_manual(values=c('plum2', 'skyblue1')) +
  labs(
    title = "Kierunki - ich wynagrodzenie świeżo po studiach i po 10 latach",
    y = NULL,
    x = "Zarobki w dollarach ($)"
  ) + theme_bw()
```

Ostatni wykres pokazuje pełny krajobraz opłacalności studiów. Choć kolory błękitne (STEM) dominują w górnej części wykresu, potwierdzając swoją rynkową siłę, to rozpiętość słupków fioletowych (Others) ujawnia ogromny potencjał kierunków biznesowych i humanistycznych. Ostatecznie 'Złoty Bilet' to nie tylko wybór kierunku z wysokim startem, ale świadomość, że w niektórych dziedzinach (Economics, Finance) prawdziwy zysk finansowy przychodzi dopiero z czasem, często wyrównując szanse w starciu z inżynierami i informatykami. Dużo zależy od ambicji i starań osobistych studenta i choć uważam, iż "the American Dream" o bogactwie i możliwościach dla wszystkich jest niestety bardzo przekolorowane to szanse na spokojne i wygodne życie tkwieją w każdej dziedzinie.

Mogę jedynie słownie podsumować stan aktualnego wynagrodzenia (a nie tego sprzed 9 lat) w którym nie powinniśmy zobaczyć za dużych różnic z tym co przedstawiłam powyżej. STEM będzie królować na długo, gdyż jest katalistem do kroków w przyszłość - choć próg wejsciowy na ten rynek staje sie coraz trudniejszy (za czym stoi dynamiczny rozwój sztucznej inteligencji). Osobiście uważam, że każdy zawód (nawet lekarski) czuje presje bycia zastąpionym przez AI. 

"Złotym Biletem" na przyszlość to nie tylko co studiujemy ("TE" z pojęcia STEM) ale przede wszystkim gdzie (na zachodnim wybrzeżu Ameryki czy może na AGH..), gdyż doedukować można się przez internet lub publiczne biblioteki ale zawarcie kontaktów przyszłościowych to jedna z największych zalet prestiżowej uczelni.

---

## Źródła naukowe

By zniwelować jakiekolwiek wątpliwości co do samodzielności mojej pracy dołączam źródła zewnętrzne z których korzystałam i nie tylko - dużo moich informacji pochodzi również z dyskusji na StackOverflow i Geeks4Geeks. Dużo linków do zewnętrznych źródeł znalazłam poprzez okna RStudio - Packages & Help

https://bookdown.org/yihui/rmarkdown/

https://github.com/rstudio/cheatsheets/tree/main  

https://tidyverse.org/  

https://www.datanovia.com/en/blog/top-r-color-palettes-to-know-for-great-data-visualization/

https://r-charts.com/colors/

https://r-graph-gallery.com/

https://cran.r-project.org/web/packages/corrplot/vignettes/corrplot-intro.html

https://ggrepel.slowkow.com/